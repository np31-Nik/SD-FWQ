<!DOCTYPE HTML>
<HTML>

<HEAD>

<TITLE>Pagina Inicial</TITLE>
<<<<<<< HEAD
<!---<script type="text/javascript" src="../Registry/API_Registry.js/"></script>--->
=======
>>>>>>> b75e2b287f57aef48f01cfb2aebd1ef5242b229d
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<system.webServer>
    <httpProtocol>
      <customHeaders>
        <add name="Access-Control-Allow-Origin" value="*"/>
      </customHeaders>
    </httpProtocol>
<system.webServer>
</HEAD>

<BODY>

<h1>Pagina de Visitantes</h1>

<form>
<label for="fname">Username:</label>
<input type="text" id="fname" name="fname"><br><br>
<label for="fname">Password:</label>
<input type="text" id="fpass" name="fpass"><br><br>

<h5>Start Ad-Placer!</h5>
<input type="submit" value="Start" onclick="submit()">

<button type="button" onclick="prueba()">Execute</button>
<button type="button" onclick="iniciarSesion()" id="login">Iniciar sesion</button>

<div id="output">
</div>

<p id="output2">

</p>

</form>

<script>
    function myFunction() {
        console.log("Hello from Firefox code");
        alert("xhr.response");
    } 

</script>

<script>
async function prueba(){
    
    const list = document.createDocumentFragment();

        var output=document.getElementById("output");

        let response = await fetch('http://localhost:3000/usuarios').then((response) => {
      return response.json();
    })
    .then((data) => {
      let authors = data;

      authors.map(function(author) {
        let li = document.createElement('li');
        let name = document.createElement('h2');
        let email = document.createElement('span');

        name.innerHTML = `${author.username}`;
        email.innerHTML = `${author.password}`;

        li.appendChild(name);
        li.appendChild(email);
        list.appendChild(li);
      });
    });
    output.appendChild(list);

    }
    
</script>

<script>
    function comprobarUsuario(){
        const http=new XMLHttpRequest();
<<<<<<< HEAD
        cad="Debe introducir nombre de usuario y contrasenya";
        var output=document.getElementById("output");
        output.innerHTML=cad;
        const url = 'http://localhost:3000/usuarios/';
        http.open("GET",url+"u2",true);
        //http.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
        
=======
        const url = 'http://localhost:3000/usuarios/';
        http.open("GET",url);
        http.send();
>>>>>>> b75e2b287f57aef48f01cfb2aebd1ef5242b229d

        http.onload=()=>{
            console.log("Hello from Firefox code");
            console.log(http.responseText);
<<<<<<< HEAD
            //console.log(http.responseText);
            //console.log(respuesta);
        }
        http.send();

    }
    
</script>

<script>
    function iniciarSesion(){ //Hacer GET y comprobar que coinciden los datos
=======
        }
    }
    
    function iniciarSesion(){
>>>>>>> b75e2b287f57aef48f01cfb2aebd1ef5242b229d
        var username=document.getElementById('fname').value;
        var password=document.getElementById('fpass').value;
        if(username.length!=0 && password!=0){
            return;
        }
        else{
            cad="Debe introducir nombre de usuario y contrasenya";
            var output=document.getElementById("output");
            output.innerHTML=cad;
        }
    }

</script>

<script>
    function Registrarse(){ //HACER REQUEST POST!
        var username=document.getElementById('fname').value;
        var password=document.getElementById('fpass').value;
        if(username.length!=0 || password!=0){
            const http=new XMLHttpRequest();
            const url = 'http://localhost:3000/usuarios/';
            http.open("POST",url);
            http.send();
            return;
        }
        else{
            cad="Debe introducir nombre de usuario y contrasenya";
            var output=document.getElementById("output");
            output.innerHTML=cad;
            if (true){
                cad="este usuario ya existe"
            }
            if(true){
                cad="Usuario registrado"
            }
        }
    }

</script>

</BODY>

</HTML>